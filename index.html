<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Ploutoforos Â· MÃ©todo de Opciones</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- TradingView -->
  <script src="https://s3.tradingview.com/tv.js"></script>

  <style>
    :root {
      --bg: #0d1117;
      --panel: #161b22;
      --text: #c9d1d9;
      --muted: #8b949e;
      --accent: #58a6ff;
      --green: #2ea043;
      --red: #f85149;
      --yellow: #d29922;
    }

    * { box-sizing: border-box; font-family: system-ui, sans-serif; }
    body { margin: 0; background: var(--bg); color: var(--text); }

    header {
      padding: 16px;
      background: #010409;
      border-bottom: 1px solid #30363d;
    }

    h1 { margin: 0; font-size: 20px; }
    h2 { margin-top: 0; font-size: 16px; }

    main {
      display: grid;
      grid-template-columns: 1fr 380px;
      gap: 16px;
      padding: 16px;
    }

    .panel {
      background: var(--panel);
      border-radius: 10px;
      padding: 16px;
      border: 1px solid #30363d;
    }

    label {
      display: block;
      margin-top: 10px;
      font-size: 13px;
      color: var(--muted);
    }

    select, input, button {
      width: 100%;
      margin-top: 6px;
      padding: 8px;
      background: #0d1117;
      border: 1px solid #30363d;
      color: var(--text);
      border-radius: 6px;
    }

    button {
      cursor: pointer;
      background: var(--accent);
      color: #000;
      font-weight: 600;
      margin-top: 12px;
    }

    .preset {
      display: flex;
      gap: 8px;
      margin-top: 10px;
    }

    .preset button {
      flex: 1;
      background: #21262d;
      color: var(--text);
    }

    .signal {
      margin-top: 12px;
      padding: 10px;
      border-radius: 8px;
      font-size: 14px;
    }

    .buy { background: rgba(46,160,67,0.15); border: 1px solid var(--green); }
    .sell { background: rgba(248,81,73,0.15); border: 1px solid var(--red); }
    .neutral { background: rgba(210,153,34,0.15); border: 1px solid var(--yellow); }

    footer {
      padding: 12px;
      text-align: center;
      font-size: 12px;
      color: var(--muted);
    }

    @media(max-width: 900px) {
      main { grid-template-columns: 1fr; }
    }
  </style>
</head>

<body>

<header>
  <h1>Ploutoforos Â· MÃ©todo de Opciones</h1>
</header>

<main>

  <!-- GRÃFICO -->
  <div class="panel">
    <h2>GrÃ¡fico de Velas + Contexto</h2>
    <div id="tv_chart" style="height: 520px;"></div>
  </div>

  <!-- CONTROL -->
  <div class="panel">
    <h2>Panel EstratÃ©gico</h2>

    <label>Ticker</label>
    <select id="ticker">
      <option value="AAPL">AAPL</option>
      <option value="MSFT">MSFT</option>
      <option value="SPY">SPY</option>
      <option value="NVDA">NVDA</option>
    </select>

    <label>Estrategia</label>
    <select id="strategy">
      <option value="buy_call">Compra de CALL</option>
      <option value="covered_call">Venta de COVERED CALL</option>
    </select>

    <label>Precio subyacente</label>
    <input id="price" type="number" value="100" />

    <label>Strike</label>
    <input id="strike" type="number" value="105" />

    <label>Prima</label>
    <input id="premium" type="number" value="3" />

    <div class="preset">
      <button onclick="preset('cons')">Conservador</button>
      <button onclick="preset('aggr')">Agresivo</button>
    </div>

    <button onclick="calculate()">Calcular seÃ±al</button>

    <div id="output"></div>
  </div>

</main>

<footer>
  Ploutoforos Â· Donde el anÃ¡lisis se convierte en riqueza
</footer>

<script>
  function loadChart(symbol) {
    new TradingView.widget({
      container_id: "tv_chart",
      symbol: symbol,
      interval: "D",
      theme: "dark",
      style: "1",
      locale: "es",
      hide_side_toolbar: false,
      allow_symbol_change: false,
      height: "100%",
      width: "100%"
    });
  }

  loadChart("AAPL");

  document.getElementById("ticker").addEventListener("change", e => {
    document.getElementById("tv_chart").innerHTML = "";
    loadChart(e.target.value);
  });

  function preset(type) {
    if (type === "cons") {
      strike.value = Number(price.value) * 1.05;
      premium.value = 2;
    } else {
      strike.value = Number(price.value) * 1.02;
      premium.value = 4;
    }
  }

  function calculate() {
    const p = Number(price.value);
    const s = Number(strike.value);
    const pr = Number(premium.value);
    const strat = strategy.value;

    let html = "";

    if (strat === "buy_call") {
      const breakeven = s + pr;
      html = `
        <div class="signal buy">
          ðŸ“ˆ <b>Compra de CALL</b><br>
          Break-even: ${breakeven.toFixed(2)}<br>
          Riesgo limitado a la prima<br>
          Escenario ideal: ruptura alcista
        </div>
      `;
    } else {
      const maxGain = pr;
      html = `
        <div class="signal sell">
          ðŸ§¾ <b>Venta de COVERED CALL</b><br>
          Ganancia mÃ¡xima: ${maxGain.toFixed(2)}<br>
          Ingreso por prima<br>
          Escenario ideal: lateral / levemente alcista
        </div>
      `;
    }

    output.innerHTML = html;
  }
</script>

</body>
</html>

